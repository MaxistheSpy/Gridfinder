# What is gridfinder?
Gridfinder is a python script and module for 3d slicer meant to automatically segment small high density objects from ct scans allowing for significantly faster processing. We do this by creating a holder with “wells” which are square shaped holes with an ordering so that samples can be quickly named on bulk. Moreover if the objects being scanned have some inherent grouping such as otolith pairs, they can be grouped together by simply placing them in the same well. Gridfinder will automatically combine any objects within a well into the same file for export. Furthermore the number and size of wells in the holder can be scaled up or down. All the algorithm cares about is that there are separate squares in the correct pattern. This means that the smaller your objects are the smaller you can make the grid meaning the more things you can scan at once. The grid can also be any height allowing for holders to be stacked onto of each other for even more scans in parallel. Although the algorithm currently only processes one layer at a time so you will need to select out the regions by height.
## beta:
Gridfinder is currently in a beta stage. While the algorithm does work it is prone to breakages. A full rewrite is planned soon to fix many of these issues. If you’re interested in using gridfinder in your work reach out to me or check back in a few months for a more stable build. Currently it does work on my system (Pop! OS linux) this program may crash or cause other undefined behavior. You have been warned. That being said if you do find any bugs please let me know either by opening an issue on GitHub or emailing me at mmcknigh@pitzer.edu
## Installing:
Currently to install gridfinder you must download this repository in its entirety, then open 3d slicer use the search to bring up the “modular wizard” select the downloaded folder and import the module. Then it should show up in slicer as “gridfinder”
### use:
Currently Gridfinder has a variety of fields
The first feild input scan takes the file path of the scan to be imported in an .nii.gz format. If your file is not in that format simply import it into slicer and then save it as a .nii.gz file. The import button will import the scan. The segment button will segment out all the large dense objects in the holder. The apply button will run run the Gridfinder algorithm to find the grid in the image. If it worked each object should appear highlighted in color in the 2d view on slicer. The colors increment through the rainbow by well position. Ie well number one will always be red. Anything paired together and considered in the same well will share an exact color value. This is so that you can easily tell what the algorithm has determined. Please note since the gradient only goes through the rainbow once with large numbers of wells the colors difference between successive wells will shrink. The next button, create manifest will create a spreadsheet with the well numbers, simply put the name you would like the object to have in the second column and click export then the module will export the contents of each well into a separate file.

Scans and example 3d models will be uploaded shortly here is a link to the example scans used for testing as well as a variety of other  taken during development. Not all of the other scans are using the current Gridfinder design plan as some were tests of other methods. https://pitzer.box.com/s/fw67ytdz6pj9voilfz3zerdpvcf2fu1i

## performance and limitations

While theoretically the method described has significant potential there is still much room for improvement in the software implementation. I do not know everyone’s use case as such feedback about what areas to focus on is welcomed especially if it comes with information about how you do ct scans, why you might be using this tool, what constraints do you have etc. 
### Memory
For one the algorithm is quite memory intensive, this is also somewhat a feature of the way slicer implements object viewing. There are methods to improve this in the future such as having Gridfinder create regions of interest around each grid square before segmenting which should massively decrease the memory footprint as segmentation is the most memory intensive step. Another option is to implement a streaming connected components algorithm.
### Filetypes & ease of use
Currently Gridfinder only works on one of many supported slicer filetypes. Expansion of this is important and should be relatively easy, however because of the ease of manual file type conversion, and current design considerations this is not a priority export file types are a priority however. Additionally it would be ideal to expand Gridfinder beyond 3D slicer, however since users can simply export scans and then process the exported scans in their editor of choice that is a low priority. Finally the UI needs significant improvement.
### Reliability
The current top priority is reliability. Gridfinder will not be particularly useful and in fact may be detrimental if it does not consistently work. Refining the algorithm such that it works in >95% of cases would be ideal. And is very possible given current technology. A secondary part of this is versatility. Gridfinder is supposed to work with any number and size of squares in the grid. But no testing has been done around this. Improved user input in cases where automatic detection fails is planned.

### Quality
While the Gridfinder algorithm just selects parts of the sample and should not degrade the quality of the scan there is a concern that having many dense objects in close proximity may cause blockage of rays leading too diminished quality of scans. Further research is needed to evaluate the possibility of this. 